@model FreePBXAIAssistant.Models.DashboardViewModel
@{
    ViewData["Title"] = "Dashboard";
}

<style>
    .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 32px;
    }

    .action-buttons {
        display: flex;
        gap: 12px;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
    }

    .stat-card {
        background: var(--surface);
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
    }

        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
        }

        .stat-card.primary {
            background: linear-gradient(135deg, #1e7e5f 0%, #165d47 100%);
            color: white;
        }

    .stat-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
    }

    .stat-title {
        font-size: 14px;
        font-weight: 500;
        opacity: 0.9;
    }

    .stat-card.primary .stat-title {
        color: rgba(255, 255, 255, 0.9);
    }

    .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 10px;
        background: rgba(0, 0, 0, 0.05);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
    }

    .stat-card.primary .stat-icon {
        background: rgba(255, 255, 255, 0.2);
    }

    .stat-value {
        font-size: 36px;
        font-weight: 700;
        margin-bottom: 8px;
    }

    .stat-change {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        opacity: 0.8;
    }

    .stat-card.primary .stat-change {
        color: rgba(255, 255, 255, 0.9);
    }

    .content-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 24px;
        margin-bottom: 24px;
    }

    .card {
        background: var(--surface);
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }

    .card-title {
        font-size: 18px;
        font-weight: 600;
    }

    .chart-container {
        height: 300px;
        display: flex;
        align-items: flex-end;
        justify-content: space-around;
        gap: 12px;
        padding: 20px 0;
    }

    .bar {
        flex: 1;
        background: var(--primary);
        border-radius: 8px 8px 0 0;
        position: relative;
        transition: all 0.3s;
        min-height: 40px;
    }

        .bar:hover {
            opacity: 0.8;
            transform: translateY(-4px);
        }

        .bar.empty {
            background: var(--border);
            opacity: 0.3;
        }

    .bar-label {
        position: absolute;
        bottom: -25px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 12px;
        color: var(--text-secondary);
        font-weight: 500;
    }

    .recent-calls-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .call-item {
        padding: 16px;
        border: 1px solid var(--border);
        border-radius: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: all 0.2s;
    }

        .call-item:hover {
            border-color: var(--primary);
            background: var(--primary-light);
        }

    .call-info {
        flex: 1;
    }

    .call-number {
        font-weight: 600;
        font-size: 14px;
        margin-bottom: 4px;
    }

    .call-meta {
        font-size: 12px;
        color: var(--text-secondary);
    }

    .call-status {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }

    .status-completed {
        background: #d1fae5;
        color: #065f46;
    }

    .status-transferred {
        background: #dbeafe;
        color: #1e40af;
    }

    .status-in-progress {
        background: #fef3c7;
        color: #92400e;
    }

    .intent-distribution {
        display: flex;
        flex-direction: column;
        gap: 16px;
    }

    .intent-item {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .intent-label {
        min-width: 120px;
        font-size: 14px;
        color: var(--text-secondary);
    }

    .intent-bar {
        flex: 1;
        height: 32px;
        background: var(--border);
        border-radius: 8px;
        overflow: hidden;
        position: relative;
    }

    .intent-fill {
        height: 100%;
        background: var(--primary);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding: 0 12px;
        color: white;
        font-size: 12px;
        font-weight: 600;
        transition: width 0.5s ease;
    }

    .system-status {
        display: flex;
        gap: 12px;
        align-items: center;
        padding: 12px 16px;
        border-radius: 10px;
        background: var(--primary-light);
    }

    .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: var(--success);
        animation: pulse 2s infinite;
    }

    @@keyframes pulse {
        0%, 100% {
            opacity: 1;
        }

        50% {
            opacity: 0.5;
        }
    }

    .status-text {
        font-size: 14px;
        font-weight: 600;
        color: var(--primary);
    }

    @@media (max-width: 1200px) {
        .content-grid {
            grid-template-columns: 1fr;
        }
    }

    @@media (max-width: 768px) {
        .stats-grid {
            grid-template-columns: 1fr;
        }

        .dashboard-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 16px;
        }
    }
</style>

<div class="page-header">
    <div class="dashboard-header">
        <div>
            <h1 class="page-title">Dashboard</h1>
            <p class="page-subtitle">Plan, prioritize, and monitor your AI assistant calls</p>
        </div>
        <div class="action-buttons">
            <button class="btn btn-primary">
                <span>+ New Call</span>
            </button>
            <button class="btn btn-secondary">
                Export Data
            </button>
        </div>
    </div>
</div>

<div class="stats-grid">
    <div class="stat-card primary">
        <div class="stat-header">
            <span class="stat-title">Total Calls Today</span>
            <div class="stat-icon">📊</div>
        </div>
        <div class="stat-value">@Model.TotalCallsToday</div>
        <div class="stat-change">
            <span>📈</span>
            <span>Increased from last month</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <span class="stat-title">Active Calls</span>
            <div class="stat-icon">📞</div>
        </div>
        <div class="stat-value">@Model.ActiveCalls</div>
        <div class="stat-change">
            <span>📈</span>
            <span>Increased from last month</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <span class="stat-title">Running Calls</span>
            <div class="stat-icon">▶️</div>
        </div>
        <div class="stat-value">@Model.ResolvedCalls</div>
        <div class="stat-change">
            <span>📈</span>
            <span>Increased from last month</span>
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-header">
            <span class="stat-title">Transferred</span>
            <div class="stat-icon">🔄</div>
        </div>
        <div class="stat-value">@Model.TransferredCalls</div>
        <div class="stat-change">
            <span>On Discuss</span>
        </div>
    </div>
</div>

<div class="content-grid">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">Call Analytics</h2>
        </div>
        <div class="chart-container">
            <div class="bar" style="height: 45%;">
                <span class="bar-label">M</span>
            </div>
            <div class="bar" style="height: 75%;">
                <span class="bar-label">T</span>
            </div>
            <div class="bar" style="height: 85%;">
                <span class="bar-label">W</span>
            </div>
            <div class="bar empty" style="height: 20%;">
                <span class="bar-label">T</span>
            </div>
            <div class="bar empty" style="height: 20%;">
                <span class="bar-label">F</span>
            </div>
            <div class="bar empty" style="height: 20%;">
                <span class="bar-label">S</span>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h2 class="card-title">System Status</h2>
        </div>
        <div class="system-status">
            <div class="status-indicator"></div>
            <span class="status-text">@Model.SystemStatus</span>
        </div>
        <div style="margin-top: 24px;">
            <h3 style="font-size: 14px; font-weight: 600; margin-bottom: 16px;">Intent Distribution</h3>
            <div class="intent-distribution">
                @foreach (var intent in Model.IntentDistribution.Take(5))
                {
                    var percentage = Model.IntentDistribution.Values.Sum() > 0
                    ? (intent.Value * 100.0 / Model.IntentDistribution.Values.Sum())
                    : 0;
                    <div class="intent-item">
                        <span class="intent-label">@intent.Key</span>
                        <div class="intent-bar">
                            <div class="intent-fill" style="width: @(percentage)%">
                                @intent.Value
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Recent Calls</h2>
        <a asp-controller="Calls" asp-action="Index" class="btn btn-secondary">View All</a>
    </div>
    <div class="recent-calls-list">
        @foreach (var call in Model.RecentCalls.Take(5))
        {
            <div class="call-item">
                <div class="call-info">
                    <div class="call-number">@call.CallerNumber</div>
                    <div class="call-meta">
                        @call.Intent • @call.StartTime.ToString("MMM dd, yyyy HH:mm") • @call.DurationSeconds sec
                    </div>
                </div>
                <span class="call-status @($"status-{call.Outcome.ToLower().Replace(" ", "-")}")">
                    @call.Outcome
                </span>
            </div>
        }
    </div>
</div>